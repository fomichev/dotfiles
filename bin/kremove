#!/bin/sh

if [ -z $1 ]; then
	ver=`cat include/config/kernel.release`
else
	ver=$1
fi

path=$(find /boot -name vmlinuz-$ver | head -1)
version=$(echo $path | sed 's@/boot/vmlinuz-@@')

echo "Remove kernel ($version)..."
sudo rm -rf \
	/boot/initrd.img-$version \
	/boot/initramfs-$version.img \
	/boot/config-$version \
	/boot/System.map-$version \
	/boot/vmlinuz-$version \
	/lib/modules/$version

echo "Update grub..."
if [ -e /sbin/grubby ]; then
	sudo grubby --remove-kernel=$path
else
	sudo update-grub
fi
